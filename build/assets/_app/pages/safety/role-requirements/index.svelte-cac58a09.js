var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,c=(t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;import{S as l,i as o,s as i,j as f,m as h,o as $,v as m,r as p,w as u,z as d,l as g,f as y,B as k,u as v,d as b,G as w,I as x,J as j,e as I,c as E,a as O,b as _,a0 as S,a7 as D,a8 as T,k as P,n as H,D as N,L as V,V as B,a9 as C,t as J,g as q,H as A,$ as R,h as z}from"../../../chunks/vendor-483ca6b6.js";import{s as G}from"../../../chunks/auth-c13ad024.js";import{I as L,g as Y,s as F}from"../../../chunks/_transitions-34f54501.js";import{C as K,S as M}from"../../../chunks/Spinner-460fa24f.js";import{C as Q}from"../../../chunks/Checkbox-6f8586bf.js";import{S as U}from"../../../chunks/Select-2b3a6ae9.js";import{T as W}from"../../../chunks/Table-c26e4894.js";import{m as X}from"../../../chunks/store-b327666d.js";import{S as Z}from"../../../chunks/Section-69710e66.js";import"../../../chunks/store-97111950.js";import"../../../chunks/store-a8f0f898.js";function ee(e,t,n){const s=e.slice();return s[28]=t[n].title,s[25]=R(t[n],["title"]),s}function te(e,t,n){const s=e.slice();return s[21]=t[n],s[22]=t,s[23]=n,s}function ne(e,t,n){const s=e.slice();return s[24]=t[n].key,s[25]=R(t[n],["key"]),s[26]=t,s[27]=n,s}function se(e){let t,n;return t=new M({}),{c(){f(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,s){$(t,e,s),n=!0},p:w,i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){p(t.$$.fragment,e),n=!1},d(e){u(t,e)}}}function ae(e){let t,n,s,a,r,c,l,o;function i(t){e[13](t)}let d={options:e[3],class:"flex-grow-0"};void 0!==e[0]&&(d.value=e[0]),n=new U({props:d}),x.push((()=>j(n,"value",i))),n.$on("change",e[8]);let w=e[6]&&re(e),S=""!==e[0]&&le(e);return{c(){t=I("div"),f(n.$$.fragment),a=P(),r=I("div"),w&&w.c(),c=P(),S&&S.c(),l=g(),this.h()},l(e){t=E(e,"DIV",{class:!0});var s=O(t);h(n.$$.fragment,s),a=H(s),r=E(s,"DIV",{class:!0});var o=O(r);w&&w.l(o),o.forEach(b),s.forEach(b),c=H(e),S&&S.l(e),l=g(),this.h()},h(){_(r,"class","flex space-x-[8px]"),_(t,"class","flex justify-between w-full items-center space-x-[16px]")},m(e,s){y(e,t,s),$(n,t,null),N(t,a),N(t,r),w&&w.m(r,null),y(e,c,s),S&&S.m(e,s),y(e,l,s),o=!0},p(e,t){const a={};8&t[0]&&(a.options=e[3]),!s&&1&t[0]&&(s=!0,a.value=e[0],V((()=>s=!1))),n.$set(a),e[6]?w?(w.p(e,t),64&t[0]&&m(w,1)):(w=re(e),w.c(),m(w,1),w.m(r,null)):w&&(k(),p(w,1,1,(()=>{w=null})),v()),""!==e[0]?S?(S.p(e,t),1&t[0]&&m(S,1)):(S=le(e),S.c(),m(S,1),S.m(l.parentNode,l)):S&&(k(),p(S,1,1,(()=>{S=null})),v())},i(e){o||(m(n.$$.fragment,e),m(w),m(S),o=!0)},o(e){p(n.$$.fragment,e),p(w),p(S),o=!1},d(e){e&&b(t),u(n),w&&w.d(),e&&b(c),S&&S.d(e),e&&b(l)}}}function re(e){let t,n,s,a,r;return n=new L({props:{theme:"success",$$slots:{default:[ce]},$$scope:{ctx:e}}}),n.$on("click",e[9]),{c(){t=I("div"),f(n.$$.fragment),this.h()},l(e){t=E(e,"DIV",{class:!0});var s=O(t);h(n.$$.fragment,s),s.forEach(b),this.h()},h(){_(t,"class","flex")},m(e,s){y(e,t,s),$(n,t,null),r=!0},p(e,t){const s={};1&t[1]&&(s.$$scope={dirty:t,ctx:e}),n.$set(s)},i(e){r||(m(n.$$.fragment,e),S((()=>{a&&a.end(1),s||(s=D(t,Y,{})),s.start()})),r=!0)},o(e){p(n.$$.fragment,e),s&&s.invalidate(),a=T(t,F,{}),r=!1},d(e){e&&b(t),u(n),e&&a&&a.end()}}}function ce(e){let t,n;return t=new B({props:{src:C,class:"w-[24px] h-[24px]"}}),{c(){f(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,s){$(t,e,s),n=!0},p:w,i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){p(t.$$.fragment,e),n=!1},d(e){u(t,e)}}}function le(e){let t,n;return t=new W({props:{$$slots:{tbody:[pe],thead:[ie]},$$scope:{ctx:e}}}),{c(){f(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,s){$(t,e,s),n=!0},p(e,n){const s={};50&n[0]|1&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){p(t.$$.fragment,e),n=!1},d(e){u(t,e)}}}function oe(e){let t,n,s=e[28]+"";return{c(){t=I("th"),n=J(s),this.h()},l(e){t=E(e,"TH",{class:!0});var a=O(t);n=q(a,s),a.forEach(b),this.h()},h(){var n;_(t,"class",ye+" "+("checkbox"===(null==(n=e[25])?void 0:n.type)?"w-[24px]":""))},m(e,s){y(e,t,s),N(t,n)},p:w,d(e){e&&b(t)}}}function ie(e){let t,n,s,a,r,c,l;function o(t){e[16](t)}function i(t){e[17](t)}let d={};void 0!==e[4]&&(d.checked=e[4]),void 0!==e[5]&&(d.indeterminate=e[5]),s=new Q({props:d}),x.push((()=>j(s,"checked",o))),x.push((()=>j(s,"indeterminate",i))),s.$on("change",e[7]);let g=e[10],k=[];for(let f=0;f<g.length;f+=1)k[f]=oe(ee(e,g,f));return{c(){t=I("thead"),n=I("th"),f(s.$$.fragment),c=P();for(let e=0;e<k.length;e+=1)k[e].c();this.h()},l(e){t=E(e,"THEAD",{slot:!0});var a=O(t);n=E(a,"TH",{class:!0});var r=O(n);h(s.$$.fragment,r),r.forEach(b),c=H(a);for(let t=0;t<k.length;t+=1)k[t].l(a);a.forEach(b),this.h()},h(){_(n,"class",ye+" w-[24px]"),_(t,"slot","thead")},m(e,a){y(e,t,a),N(t,n),$(s,n,null),N(t,c);for(let n=0;n<k.length;n+=1)k[n].m(t,null);l=!0},p(e,n){const c={};if(!a&&16&n[0]&&(a=!0,c.checked=e[4],V((()=>a=!1))),!r&&32&n[0]&&(r=!0,c.indeterminate=e[5],V((()=>r=!1))),s.$set(c),1024&n[0]){let s;for(g=e[10],s=0;s<g.length;s+=1){const a=ee(e,g,s);k[s]?k[s].p(a,n):(k[s]=oe(a),k[s].c(),k[s].m(t,null))}for(;s<k.length;s+=1)k[s].d(1);k.length=g.length}},i(e){l||(m(s.$$.fragment,e),l=!0)},o(e){p(s.$$.fragment,e),l=!1},d(e){e&&b(t),u(s),A(k,e)}}}function fe(e){let t,n=e[21][e[24]]+"";return{c(){t=J(n)},l(e){t=q(e,n)},m(e,n){y(e,t,n)},p(e,s){2&s[0]&&n!==(n=e[21][e[24]]+"")&&z(t,n)},i:w,o:w,d(e){e&&b(t)}}}function he(e){let t,n,s,a;function r(t){e[15](t,e[21],e[24])}let c={};return void 0!==e[21][e[24]]&&(c.checked=e[21][e[24]]),n=new Q({props:c}),x.push((()=>j(n,"checked",r))),{c(){t=I("div"),f(n.$$.fragment),this.h()},l(e){t=E(e,"DIV",{class:!0});var s=O(t);h(n.$$.fragment,s),s.forEach(b),this.h()},h(){_(t,"class","flex justify-center")},m(e,s){y(e,t,s),$(n,t,null),a=!0},p(t,a){e=t;const r={};!s&&1026&a[0]&&(s=!0,r.checked=e[21][e[24]],V((()=>s=!1))),n.$set(r)},i(e){a||(m(n.$$.fragment,e),a=!0)},o(e){p(n.$$.fragment,e),a=!1},d(e){e&&b(t),u(n)}}}function $e(e){let t,n,s,a;const r=[he,fe],c=[];var l;return n="checkbox"===(null==(l=e[25])?void 0:l.type)?0:1,s=c[n]=r[n](e),{c(){t=I("td"),s.c(),this.h()},l(e){t=E(e,"TD",{class:!0});var n=O(t);s.l(n),n.forEach(b),this.h()},h(){_(t,"class",ye)},m(e,s){y(e,t,s),c[n].m(t,null),a=!0},p(e,t){s.p(e,t)},i(e){a||(m(s),a=!0)},o(e){p(s),a=!1},d(e){e&&b(t),c[n].d()}}}function me(e){let t,n,s,a,r,c,l;function o(t){e[14](t,e[21])}let i={};void 0!==e[21].checked&&(i.checked=e[21].checked),s=new Q({props:i}),x.push((()=>j(s,"checked",o)));let d=e[10],g=[];for(let f=0;f<d.length;f+=1)g[f]=$e(ne(e,d,f));const w=e=>p(g[e],1,1,(()=>{g[e]=null}));return{c(){t=I("tr"),n=I("td"),f(s.$$.fragment),r=P();for(let e=0;e<g.length;e+=1)g[e].c();c=P(),this.h()},l(e){t=E(e,"TR",{class:!0});var a=O(t);n=E(a,"TD",{class:!0});var l=O(n);h(s.$$.fragment,l),l.forEach(b),r=H(a);for(let t=0;t<g.length;t+=1)g[t].l(a);c=H(a),a.forEach(b),this.h()},h(){_(n,"class",ye),_(t,"class","rounded transition duration-200 bg-white bg-opacity-0 hover:bg-opacity-[2%]")},m(e,a){y(e,t,a),N(t,n),$(s,n,null),N(t,r);for(let n=0;n<g.length;n+=1)g[n].m(t,null);N(t,c),l=!0},p(n,r){e=n;const l={};if(!a&&2&r[0]&&(a=!0,l.checked=e[21].checked,V((()=>a=!1))),s.$set(l),1026&r[0]){let n;for(d=e[10],n=0;n<d.length;n+=1){const s=ne(e,d,n);g[n]?(g[n].p(s,r),m(g[n],1)):(g[n]=$e(s),g[n].c(),m(g[n],1),g[n].m(t,c))}for(k(),n=d.length;n<g.length;n+=1)w(n);v()}},i(e){if(!l){m(s.$$.fragment,e);for(let e=0;e<d.length;e+=1)m(g[e]);l=!0}},o(e){p(s.$$.fragment,e),g=g.filter(Boolean);for(let t=0;t<g.length;t+=1)p(g[t]);l=!1},d(e){e&&b(t),u(s),A(g,e)}}}function pe(e){let t,n,s=e[1],a=[];for(let c=0;c<s.length;c+=1)a[c]=me(te(e,s,c));const r=e=>p(a[e],1,1,(()=>{a[e]=null}));return{c(){t=I("tbody");for(let e=0;e<a.length;e+=1)a[e].c();this.h()},l(e){t=E(e,"TBODY",{slot:!0});var n=O(t);for(let t=0;t<a.length;t+=1)a[t].l(n);n.forEach(b),this.h()},h(){_(t,"slot","tbody")},m(e,s){y(e,t,s);for(let n=0;n<a.length;n+=1)a[n].m(t,null);n=!0},p(e,n){if(1026&n[0]){let c;for(s=e[1],c=0;c<s.length;c+=1){const r=te(e,s,c);a[c]?(a[c].p(r,n),m(a[c],1)):(a[c]=me(r),a[c].c(),m(a[c],1),a[c].m(t,null))}for(k(),c=s.length;c<a.length;c+=1)r(c);v()}},i(e){if(!n){for(let e=0;e<s.length;e+=1)m(a[e]);n=!0}},o(e){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)p(a[t]);n=!1},d(e){e&&b(t),A(a,e)}}}function ue(e){let t,n,s,a;const r=[ae,se],c=[];function l(e,t){return e[2]?0:1}return t=l(e),n=c[t]=r[t](e),{c(){n.c(),s=g()},l(e){n.l(e),s=g()},m(e,n){c[t].m(e,n),y(e,s,n),a=!0},p(e,a){let o=t;t=l(e),t===o?c[t].p(e,a):(k(),p(c[o],1,1,(()=>{c[o]=null})),v(),n=c[t],n?n.p(e,a):(n=c[t]=r[t](e),n.c()),m(n,1),n.m(s.parentNode,s))},i(e){a||(m(n),a=!0)},o(e){p(n),a=!1},d(e){c[t].d(e),e&&b(s)}}}function de(e){let t,n;return t=new K({props:{class:"items-center space-y-[16px]",$$slots:{default:[ue]},$$scope:{ctx:e}}}),{c(){f(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,s){$(t,e,s),n=!0},p(e,n){const s={};127&n[0]|1&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){p(t.$$.fragment,e),n=!1},d(e){u(t,e)}}}function ge(e){let t,n;return t=new Z({props:{$$slots:{default:[de]},$$scope:{ctx:e}}}),{c(){f(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,s){$(t,e,s),n=!0},p(e,n){const s={};127&n[0]|1&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){p(t.$$.fragment,e),n=!1},d(e){u(t,e)}}}const ye="p-[10px]";function ke(e,l,o){let i,f,h,$;const m=async()=>{const e=await G(`/api/datatable/roles?sort=${JSON.stringify({name:1})}`);o(3,v=[{label:"Select a Role",value:""},...e.rows.map((e=>({label:e.name,value:e._id})))])},p=async()=>{const e=await G(`/api/datatable/safety-types?sort=${JSON.stringify({name:1})}`);o(1,b=e.rows.map((e=>Object.assign({checked:!1},e))))},u=()=>{o(1,b=[...b].map((e=>{return l=((e,t)=>{for(var n in t||(t={}))a.call(t,n)&&c(e,n,t[n]);if(s)for(var n of s(t))r.call(t,n)&&c(e,n,t[n]);return e})({},e),t(l,n({checked:!1}));var l})))};let g=[],y=!1,k="",v=[],b=[];return d((async()=>{await Promise.all([m(),p()]),o(2,y=!0)})),e.$$.update=()=>{2&e.$$.dirty[0]&&o(12,i=[...b].filter((e=>e.checked))),4098&e.$$.dirty[0]&&o(4,f=i.length===b.length),4098&e.$$.dirty[0]&&o(5,h=0!==i.length&&i.length!==b.length),2051&e.$$.dirty[0]&&o(6,$=""!==k&&[...b].filter((e=>e.checked)).map((e=>e._id)).sort().join(",")!==[...g].map((e=>e._id)).sort().join(","))},[k,b,y,v,f,h,$,async()=>{o(1,b=b.map((e=>(e.checked=!f,e))))},async()=>{if(u(),""!==k){X.spinner.show();const e=await G(`/api/datatable/roles?_id=${k}`),t="safetyItems"in e.rows[0]?e.rows[0].safetyItems.map((e=>e._id)):[];o(11,g="safetyItems"in e.rows[0]?[...e.rows[0].safetyItems]:[]),o(1,b=b.map((e=>(e.checked=!!t.includes(e._id),e)))),X.spinner.hide()}else o(11,g=[])},async()=>{X.spinner.show();const e=[...i].map((e=>(delete e.checked,e))),t=await G({method:"PATCH",href:`/api/datatable/roles?_id=${k}`,body:{safetyItems:e}}),n=t.doc.safetyItems.map((e=>e._id));o(11,g=[...t.doc.safetyItems]),o(1,b=b.map((e=>(e.checked=!!n.includes(e._id),e)))),X.spinner.hide()},[{title:"Name",key:"name"}],g,i,function(e){k=e,o(0,k)},function(t,n){e.$$.not_equal(n.checked,t)&&(n.checked=t,o(1,b))},function(t,n,s){e.$$.not_equal(n[s],t)&&(n[s]=t,o(1,b))},function(e){f=e,o(4,f),o(12,i),o(1,b)},function(e){h=e,o(5,h),o(12,i),o(1,b)}]}export default class extends l{constructor(e){super(),o(this,e,ke,ge,i,{},[-1,-1])}}
