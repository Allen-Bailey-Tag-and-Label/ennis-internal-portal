import{S as t,i as e,s,j as n,m as a,o as r,v as o,r as c,w as l,z as $,e as f,k as u,l as i,c as m,a as p,d as h,n as d,b as g,f as y,B as b,u as k,D as v,E as w,K as j,H as x,t as S,g as q,$ as _,I as B,J as E,L as I}from"../../../chunks/vendor-483ca6b6.js";import{s as O}from"../../../chunks/auth-c13ad024.js";import{c as C}from"../../../chunks/_columns-aa0cd4b4.js";import{B as D}from"../../../chunks/store-97111950.js";import{B as H}from"../../../chunks/Back-7e1bfb8e.js";import{C as P,S as z}from"../../../chunks/Spinner-460fa24f.js";import{S as A}from"../../../chunks/Select-2b3a6ae9.js";import{m as F}from"../../../chunks/store-b327666d.js";import{I as J}from"../../../chunks/Input-ac9b94d3.js";import{S as K}from"../../../chunks/Section-69710e66.js";import"../../../chunks/store-a8f0f898.js";function L(t,e,s){const n=t.slice();return n[7]=e[s].key,n[8]=_(e[s],["key"]),n[9]=e,n[10]=s,n}function M(t){let e,s;return e=new P({props:{$$slots:{default:[R]},$$scope:{ctx:t}}}),{c(){n(e.$$.fragment)},l(t){a(e.$$.fragment,t)},m(t,n){r(e,t,n),s=!0},p(t,s){const n={};2048&s&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){s||(o(e.$$.fragment,t),s=!0)},o(t){c(e.$$.fragment,t),s=!1},d(t){l(e,t)}}}function N(t){let e,s,$,i,S,q,_=C,B=[];for(let n=0;n<_.length;n+=1)B[n]=G(L(t,_,n));const E=t=>c(B[t],1,1,(()=>{B[t]=null}));return $=new D({props:{type:"submit",$$slots:{default:[Q]},$$scope:{ctx:t}}}),{c(){e=f("form");for(let t=0;t<B.length;t+=1)B[t].c();s=u(),n($.$$.fragment),this.h()},l(t){e=m(t,"FORM",{class:!0});var n=p(e);for(let e=0;e<B.length;e+=1)B[e].l(n);s=d(n),a($.$$.fragment,n),n.forEach(h),this.h()},h(){g(e,"class","flex flex-col mt-[24px] space-y-[16px]")},m(n,a){y(n,e,a);for(let t=0;t<B.length;t+=1)B[t].m(e,null);v(e,s),r($,e,null),i=!0,S||(q=w(e,"submit",j(t[2])),S=!0)},p(t,n){if(1&n){let a;for(_=C,a=0;a<_.length;a+=1){const r=L(t,_,a);B[a]?(B[a].p(r,n),o(B[a],1)):(B[a]=G(r),B[a].c(),o(B[a],1),B[a].m(e,s))}for(b(),a=_.length;a<B.length;a+=1)E(a);k()}const a={};2048&n&&(a.$$scope={dirty:n,ctx:t}),$.$set(a)},i(t){if(!i){for(let t=0;t<_.length;t+=1)o(B[t]);o($.$$.fragment,t),i=!0}},o(t){B=B.filter(Boolean);for(let e=0;e<B.length;e+=1)c(B[e]);c($.$$.fragment,t),i=!1},d(t){t&&h(e),x(B,t),l($),S=!1,q()}}}function R(t){let e,s;return e=new z({}),{c(){n(e.$$.fragment)},l(t){a(e.$$.fragment,t)},m(t,n){r(e,t,n),s=!0},i(t){s||(o(e.$$.fragment,t),s=!0)},o(t){c(e.$$.fragment,t),s=!1},d(t){l(e,t)}}}function T(t){let e,s,$;function f(e){t[5](e,t[7])}let u={label:t[7],placeholder:t[7]};return void 0!==t[0][t[7]]&&(u.value=t[0][t[7]]),e=new J({props:u}),B.push((()=>E(e,"value",f))),{c(){n(e.$$.fragment)},l(t){a(e.$$.fragment,t)},m(t,s){r(e,t,s),$=!0},p(n,a){t=n;const r={};!s&&1&a&&(s=!0,r.value=t[0][t[7]],I((()=>s=!1))),e.$set(r)},i(t){$||(o(e.$$.fragment,t),$=!0)},o(t){c(e.$$.fragment,t),$=!1},d(t){l(e,t)}}}function V(t){let e,s,$;function f(e){t[4](e,t[7])}let u={label:t[7],options:t[8].options};return void 0!==t[0][t[7]]&&(u.value=t[0][t[7]]),e=new A({props:u}),B.push((()=>E(e,"value",f))),{c(){n(e.$$.fragment)},l(t){a(e.$$.fragment,t)},m(t,s){r(e,t,s),$=!0},p(n,a){t=n;const r={};!s&&1&a&&(s=!0,r.value=t[0][t[7]],I((()=>s=!1))),e.$set(r)},i(t){$||(o(e.$$.fragment,t),$=!0)},o(t){c(e.$$.fragment,t),$=!1},d(t){l(e,t)}}}function G(t){let e,s,n,a;const r=[V,T],l=[];return e="type"in t[8]?0:1,s=l[e]=r[e](t),{c(){s.c(),n=i()},l(t){s.l(t),n=i()},m(t,s){l[e].m(t,s),y(t,n,s),a=!0},p(t,e){s.p(t,e)},i(t){a||(o(s),a=!0)},o(t){c(s),a=!1},d(t){l[e].d(t),t&&h(n)}}}function Q(t){let e;return{c(){e=S("Save")},l(t){e=q(t,"Save")},m(t,s){y(t,e,s)},d(t){t&&h(e)}}}function U(t){let e,s,$,v,w,j,x;s=new H({});const S=[N,M],q=[];function _(t,e){return t[1]?0:1}return v=_(t),w=q[v]=S[v](t),{c(){e=f("div"),n(s.$$.fragment),$=u(),w.c(),j=i(),this.h()},l(t){e=m(t,"DIV",{class:!0});var n=p(e);a(s.$$.fragment,n),n.forEach(h),$=d(t),w.l(t),j=i(),this.h()},h(){g(e,"class","flex")},m(t,n){y(t,e,n),r(s,e,null),y(t,$,n),q[v].m(t,n),y(t,j,n),x=!0},p(t,e){let s=v;v=_(t),v===s?q[v].p(t,e):(b(),c(q[s],1,1,(()=>{q[s]=null})),k(),w=q[v],w?w.p(t,e):(w=q[v]=S[v](t),w.c()),o(w,1),w.m(j.parentNode,j))},i(t){x||(o(s.$$.fragment,t),o(w),x=!0)},o(t){c(s.$$.fragment,t),c(w),x=!1},d(t){t&&h(e),l(s),t&&h($),q[v].d(t),t&&h(j)}}}function W(t){let e,s;return e=new K({props:{$$slots:{default:[U]},$$scope:{ctx:t}}}),{c(){n(e.$$.fragment)},l(t){a(e.$$.fragment,t)},m(t,n){r(e,t,n),s=!0},p(t,[s]){const n={};2051&s&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){s||(o(e.$$.fragment,t),s=!0)},o(t){c(e.$$.fragment,t),s=!1},d(t){l(e,t)}}}async function X({page:t}){let{query:e}=t;return e=Object.fromEntries(e),{props:{query:e}}}function Y(t,e,s){const n=async()=>{const t=await O(`/api/datatable/safety-types?_id=${o._id}`);Object.keys(a).forEach((e=>{s(0,a[e]=e in t.rows[0]?t.rows[0][e]:"",a)}))};let a=[...C].reduce(((t,e)=>(t[e.key]="select"===e.type?e.options[0].value:"",t)),{}),r=!1,{query:o}=e;return $((async()=>{await Promise.all([n()]),s(1,r=!0)})),t.$$set=t=>{"query"in t&&s(3,o=t.query)},[a,r,async()=>{F.spinner.show(),await O({method:"PATCH",href:`/api/datatable/safety-types?_id=${o._id}`,body:a}),F.spinner.hide(),F.success.show(`Successfully updated route "${a.name}"`)},o,function(e,n){t.$$.not_equal(a[n],e)&&(a[n]=e,s(0,a))},function(e,n){t.$$.not_equal(a[n],e)&&(a[n]=e,s(0,a))}]}export default class extends t{constructor(t){super(),e(this,t,Y,W,s,{query:3})}}export{X as load};
